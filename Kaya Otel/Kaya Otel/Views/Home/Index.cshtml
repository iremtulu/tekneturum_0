@{
    ViewData["Title"] = "GÃ¼nÃ¼birlik Tekne Turu Rezervasyon Sistemi";
    var tours = ViewBag.Tours as IEnumerable<Kaya_Otel.Models.Tour>;
    var featured = ViewBag.FeaturedTour as Kaya_Otel.Models.Tour;
}

<section class="hero bg-dark text-white py-5 mb-5" style="background-image: url('/images/kekova-3.webp'); background-size: cover; background-position: center;">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-7">
                <p class="text-uppercase text-primary mb-3" Kekova Ã–zel Tekne TurlarÄ± >

                    <h1 class="display-4 fw-bold">Sunset ve mehtap turlarÄ±nda yerinizi ÅŸimdi ayÄ±rtÄ±n.</h1>
<p class="lead">Kekova'nÄ±n tarihi sularÄ±nda unutulmaz bir tur deneyimi.</p>
                <div class="d-flex flex-wrap gap-3 mt-4">
                    <a asp-controller="Tour" asp-action="Index" class="btn btn-primary btn-lg">TurlarÄ± GÃ¶r</a>
                    <a href="tel:05395603136" class="animated-phone-button">
                        <span class="phone-icon">ğŸ“</span>
                        <span class="phone-number">0539 560 31 36</span>
                    </a>

</div>
            </div>
            @if (featured != null)
            {
                <div class="col-lg-5">
                    <div class="card shadow-lg">
                        <img src="@featured.ImageUrl" class="card-img-top" alt="@featured.Name" />
                        <div class="card-body">
                            <span class="badge bg-primary">@featured.Category</span>
                            <h3 class="card-title mt-2">@featured.Name</h3>
                            <p class="text-muted">@featured.Description</p>
                            <p class="fw-bold mb-3">@featured.PricePerPerson.ToString("C0") / Tur</p>
                            @{
                                var userId = Context.Session.GetInt32("UserId");
                                var userEmail = Context.Session.GetString("UserEmail");
                                var isAdmin = Context.Session.GetString("AdminGirisi") == "true";
                            }
                            <div id="featuredTourButton" @if (featured != null) { <text>data-tour-id="@featured.Id"</text> }>
                            @if (isAdmin)
                            {
                                <button type="button" class="btn btn-primary w-100" onclick="showTourDetailsModal(@featured.Id)">
                                    <i class="bi bi-info-circle"></i> Tur DetaylarÄ±
                                </button>
                            }
                            else if (userId == null && string.IsNullOrEmpty(userEmail))
                            {
                                <div class="alert alert-warning mb-3">
                                    <i class="bi bi-exclamation-triangle"></i> Rezervasyon yapmak iÃ§in Ã¼ye giriÅŸi yapmalÄ±sÄ±nÄ±z.
                                </div>
                                <a asp-controller="Account" asp-action="Register" class="btn btn-primary w-100">
                                    <i class="bi bi-person-plus"></i> KayÄ±t Ol / GiriÅŸ Yap
                                </a>
                            }
                            else
                            {
                                <a asp-controller="Booking" asp-action="Reserve" asp-route-tourId="@featured.Id" class="btn btn-primary w-100">
                                    <i class="bi bi-calendar-check"></i> Rezervasyon Yap
                                </a>
                            }
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
</section>

<section class="py-5 bg-light">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="h2 mb-2">Tur ProgramÄ±</h2>
            <p class="text-muted">Kekova Tekne Turu rotamÄ±z ve duraklarÄ±mÄ±z</p>
        </div>
        <div class="row g-4" id="tourProgram">
            <div class="col-md-6 col-lg-4 fade-in-item">
                <div class="card h-100 shadow-sm border-0">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <div class="tour-number bg-primary text-white rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px; font-weight: bold; margin-right: 15px;">1</div>
                            <h5 class="card-title mb-0">AKVARYUM KOYU</h5>
                        </div>
                        <p class="card-text text-muted">Akvaryum koyu tekne turumuzun ilk duraÄŸÄ±dÄ±r. suyunun berraklÄ±ÄŸÄ±ndan dolayÄ± Akvaryum koyu denmektedir.</p>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-4 fade-in-item">
                <div class="card h-100 shadow-sm border-0">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <div class="tour-number bg-primary text-white rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px; font-weight: bold; margin-right: 15px;">2</div>
                            <h5 class="card-title mb-0">TERSANE KOYU</h5>
                        </div>
                        <p class="card-text text-muted">Tersane koyu, eski dÃ¶nemlerde tekne bakÄ±m ve onarÄ±mÄ±nda kullanÄ±lanmÄ±ÅŸ iÃ§erisinde tarihi kalÄ±ntÄ±larÄ± bulunan bir koy ve batÄ±k ÅŸehrin bir parÃ§asÄ±dÄ±r.</p>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-4 fade-in-item">
                <div class="card h-100 shadow-sm border-0">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <div class="tour-number bg-primary text-white rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px; font-weight: bold; margin-right: 15px;">3</div>
                            <h5 class="card-title mb-0">BATIK ÅEHÄ°R</h5>
                        </div>
                        <p class="card-text text-muted">BatÄ±k ÅŸehir, Kekova adasÄ±nda bulunan dalÄ±ÅŸa ve yÃ¼zmeye kapalÄ± bir likya antik kentidir. BurayÄ± teknemizle gÃ¶rerek geÃ§iyoruz.</p>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-4 fade-in-item">
                <div class="card h-100 shadow-sm border-0">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <div class="tour-number bg-primary text-white rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px; font-weight: bold; margin-right: 15px;">4</div>
                            <h5 class="card-title mb-0">KORSAN MAÄARASI</h5>
                        </div>
                        <p class="card-text text-muted">Eski dÃ¶nemlerde iÃ§erisine korsanlarÄ±n saklandÄ±ÄŸÄ± bir deniz maÄŸarasÄ±dÄ±r.</p>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-4 fade-in-item">
                <div class="card h-100 shadow-sm border-0">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <div class="tour-number bg-primary text-white rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px; font-weight: bold; margin-right: 15px;">5</div>
                            <h5 class="card-title mb-0">GÃ–KKAYA KOYU</h5>
                        </div>
                        <p class="card-text text-muted">GÃ¶kkaya koyu Kekova'nÄ±n en bÃ¼yÃ¼k koyudur. RÃ¼zgarlÄ± ve fÄ±rtÄ±nalÄ± havalarda tekneciler iÃ§in Ã§ok korunaklÄ± bir limandÄ±r. Genellikle Ã¶ÄŸle yemeÄŸi molasÄ±nÄ± bu koyda vermekteyiz.</p>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-4 fade-in-item">
                <div class="card h-100 shadow-sm border-0">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <div class="tour-number bg-primary text-white rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px; font-weight: bold; margin-right: 15px;">6</div>
                            <h5 class="card-title mb-0">ESMERALDA KOYU</h5>
                        </div>
                        <p class="card-text text-muted">Esmeralda koyu Kale KÃ¶yÃ¼nden Ã¶nce 40 dakika yÃ¼zme ve Ã§ay molasÄ± verdiÄŸimiz suyu berrak sakin bir koydur.</p>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-4 fade-in-item">
                <div class="card h-100 shadow-sm border-0">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <div class="tour-number bg-primary text-white rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px; font-weight: bold; margin-right: 15px;">7</div>
                            <h5 class="card-title mb-0">KALE KÃ–YÃœ</h5>
                        </div>
                        <p class="card-text text-muted">Kara yolu olmayan kÃ¶y, ulaÅŸÄ±m sadece tekne ve yÃ¼rÃ¼yerek saÄŸlanmakta. Burada 1 saat gibi serbest zaman veriyoruz. Dileyen Kaleye Ã§Ä±kÄ±p o muhteÅŸem manzarayÄ± izleyebilir, isteyense kÃ¶y iÃ§erisinde ev yapÄ±mÄ± dondurmalarÄ± meÅŸhurdur dondurma yiyebilir.</p>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-4 fade-in-item">
                <div class="card h-100 shadow-sm border-0">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <div class="tour-number bg-primary text-white rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px; font-weight: bold; margin-right: 15px;">8</div>
                            <h5 class="card-title mb-0">ADALAR ARASI</h5>
                        </div>
                        <p class="card-text text-muted">Adalar arasÄ±, Kekova Tekne Turunda final koyumuz, burada kÄ±sa bir yÃ¼zme ve meyve molasÄ±ndan sonra Limana dÃ¶nÃ¼ÅŸ yapÄ±yoruz.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="py-5">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="h2 mb-2">Kekova'nÄ±n Tarihi</h2>
            <p class="text-muted">
                Kekova
                Tarihi, doÄŸasÄ± ve pÄ±rÄ±l pÄ±rÄ±l koylarÄ±yla Ã¼nlÃ¼ Kekova, adÄ±nÄ± Kale kÃ¶yÃ¼ ve ÃœÃ§aÄŸÄ±z KÃ¶yÃ¼â€™nÃ¼n tam karÅŸÄ±larÄ±nda doÄŸudan batÄ±ya doÄŸru uzanan ve Ã¼zerinde bir Ã§ok koyu ve tarihi kalÄ±ntÄ±larÄ± barÄ±ndÄ±ran Kekova adasÄ±ndan almaktadÄ±r.
                Kekova tarihi, bÃ¶lgede henÃ¼z kazÄ± Ã§alÄ±ÅŸmalarÄ± yapÄ±lmadÄ±ÄŸÄ±ndan dolayÄ± tam olarak bilinmemekle birlikte en az M.Ã– 5.yyâ€™la yani gÃ¼nÃ¼mÃ¼zden aÅŸaÄŸÄ± yukarÄ± 2500 yÄ±l kadar Ã¶ncesine dayandÄ±ÄŸÄ± tahmin edilmektedir.
                Bir Ä±ÅŸÄ±k Ã¼lkesi olarak adlandÄ±rÄ±lan LikyalÄ±lar dÃ¶nemine ait bir Ã§ok kalÄ±ntÄ± ve antik kentlerin yanÄ±sÄ±ra Bizans ve Roma dÃ¶nemlerine ait kalÄ±ntÄ±lar gÃ¶rmek mÃ¼mkÃ¼ndÃ¼r.
                LikyalÄ±lar dÃ¶nemine ait baÅŸlÄ±ca antik kentler; Kekovaâ€™nÄ±n batÄ± kÄ±smÄ±nda bulunan Aperlai ve apollonia antik kentleri, Kekova adasÄ± Ã¼zerinde bulunan ve batÄ±k kent olarak bilinen, yÄ±lda binlerce turistin tekne turlarÄ±yla ziyaret ettiÄŸi,
                yÃ¼zme ve dalÄ±ÅŸa yasak olan dolichiste antik kenti, 
                Hemen Kekova adasÄ±nÄ±n karÅŸÄ±sÄ±nda Kale KÃ¶yÃ¼nâ€™de bulunan Simena antik kenti, ÃœÃ§aÄŸÄ±z kÃ¶yÃ¼nde bulunan Theimussa, GÃ¶kkaya koyu Ã¼zerinde bulunan Istlada birbirlerine Ã§ok yakÄ±n olan ve Likya birliÄŸine baÄŸlÄ± olarak yaÅŸayan antik kentlerdir.
            </p>
            <p>
                <h2>Keyifli ve Konforlu Yolculuk </h2>
                Ã–zel tekne turumuz, konfor ve lÃ¼ksÃ¼ bir arada sunar. Profesyonel ekibimiz, size eÅŸsiz bir deneyim yaÅŸatmak iÃ§in her detayÄ± dÃ¼ÅŸÃ¼nmÃ¼ÅŸtÃ¼r. 
                GeniÅŸ ve rahat teknelerimiz, gÃ¼neÅŸlenme alanlarÄ±, ferah oturma dÃ¼zeni ve Ã¶zel yÃ¼zme molalarÄ± ile size rahat bir yolculuk sunar.
                AyrÄ±ca, Akdenizâ€™in taptaze lezzetleriyle dolu Ã¶zel ikramlarÄ±mÄ±z da bu turu daha da keyifli hale getirir.

            </p>
        </div>
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="card shadow-sm border-0 fade-in-item">
                    <div class="card-body p-5">
                        <div class="text-center text-muted">
                            
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

@{
    var instagramPosts = ViewBag.InstagramPosts as IReadOnlyList<Kaya_Otel.ViewModels.InstagramPostViewModel> ?? Array.Empty<Kaya_Otel.ViewModels.InstagramPostViewModel>();
}

@await Html.PartialAsync("~/Views/Shared/_InstagramPosts.cshtml", instagramPosts)

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver(function(entries) {
            entries.forEach((entry, index) => {
                if (entry.isIntersecting) {
                    setTimeout(() => {
                        entry.target.classList.add('visible');
                    }, index * 100);
                }
            });
        }, observerOptions);

        document.querySelectorAll('.fade-in-item').forEach(item => {
            observer.observe(item);
        });
    });
    
    // Featured tour butonunu gÃ¼ncelle
    function updateFeaturedTourButton() {
        fetch('@Url.Action("CheckSession", "Home")', {
            method: 'GET',
            cache: 'no-store',
            headers: {
                'X-Requested-With': 'XMLHttpRequest'
            }
        })
        .then(response => response.json())
        .then(data => {
            const container = document.getElementById('featuredTourButton');
            if (!container) return;
            
            const featuredTourId = container.getAttribute('data-tour-id');
            if (!featuredTourId || featuredTourId === '0') return;
            
            if (data.isAdmin) {
                container.innerHTML = `
                    <button type="button" class="btn btn-primary w-100" onclick="showTourDetailsModal(${featuredTourId})">
                        <i class="bi bi-info-circle"></i> Tur DetaylarÄ±
                    </button>
                `;
            } else if (data.isUser) {
                container.innerHTML = `
                    <a href="@Url.Action("Reserve", "Booking")?tourId=${featuredTourId}" class="btn btn-primary w-100">
                        <i class="bi bi-calendar-check"></i> Rezervasyon Yap
                    </a>
                `;
            } else {
                container.innerHTML = `
                    <div class="alert alert-warning mb-3">
                        <i class="bi bi-exclamation-triangle"></i> Rezervasyon yapmak iÃ§in Ã¼ye giriÅŸi yapmalÄ±sÄ±nÄ±z.
                    </div>
                    <a href="@Url.Action("Register", "Account")" class="btn btn-primary w-100">
                        <i class="bi bi-person-plus"></i> KayÄ±t Ol / GiriÅŸ Yap
                    </a>
                `;
            }
        })
        .catch(error => {
            console.error('Featured tour buton gÃ¼ncelleme hatasÄ±:', error);
        });
    }
    
    // Sayfa yÃ¼klendiÄŸinde ve cache'den yÃ¼klendiÄŸinde kontrol et
    window.addEventListener('load', function() {
        updateFeaturedTourButton();
    });
    window.addEventListener('pageshow', function(event) {
        if (event.persisted) {
            updateFeaturedTourButton();
        }
    });
</script>

@{
    var isAdminHome = Context.Session.GetString("AdminGirisi") == "true";
}

@if (isAdminHome)
{
    <script>
    // Tur DetaylarÄ± Modal
    function showTourDetailsModal(tourId) {
        $.ajax({
            url: '@Url.Action("GetTourDetails", "Tour")',
            type: 'GET',
            data: { id: tourId },
            dataType: 'json',
            success: function(response) {
                if (response.success && response.tour) {
                    var tour = response.tour;
                    var priceStr = parseFloat(tour.pricePerPerson).toLocaleString('tr-TR', {
                        style: 'currency',
                        currency: 'TRY',
                        minimumFractionDigits: 0
                    });
                    
                    var modalHtml = '<div class="modal fade" id="tourDetailsModal" tabindex="-1">' +
                        '<div class="modal-dialog modal-lg modal-dialog-centered">' +
                        '<div class="modal-content border-0 shadow-lg">' +
                        '<div class="modal-header bg-primary text-white">' +
                        '<h5 class="modal-title"><i class="bi bi-info-circle"></i> Tur DetaylarÄ±</h5>' +
                        '<button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>' +
                        '</div>' +
                        '<div class="modal-body p-4">' +
                        '<div class="row">' +
                        '<div class="col-md-6 mb-3">' +
                        '<img src="' + tour.imageUrl + '" alt="' + tour.name + '" class="img-fluid rounded shadow-sm">' +
                        '</div>' +
                        '<div class="col-md-6">' +
                        '<span class="badge bg-primary mb-2">' + (tour.category || 'Genel') + '</span>' +
                        '<h4 class="mb-3">' + tour.name + '</h4>' +
                        '<p class="text-muted mb-4">' + (tour.description || 'AÃ§Ä±klama bulunmamaktadÄ±r.') + '</p>' +
                        '<ul class="list-group">' +
                        '<li class="list-group-item d-flex justify-content-between align-items-center">' +
                        '<span><i class="bi bi-clock"></i> Tur SÃ¼resi</span>' +
                        '<strong>' + Math.round(tour.duration) + ' saat</strong>' +
                        '</li>' +
                        '<li class="list-group-item d-flex justify-content-between align-items-center">' +
                        '<span><i class="bi bi-people"></i> Maksimum Kapasite</span>' +
                        '<strong>' + tour.capacity + ' kiÅŸi</strong>' +
                        '</li>' +
                        '<li class="list-group-item d-flex justify-content-between align-items-center">' +
                        '<span><i class="bi bi-currency-dollar"></i> Tur Ãœcreti</span>' +
                        '<strong class="text-success">' + priceStr + '</strong>' +
                        '</li>' +
                        '<li class="list-group-item d-flex justify-content-between align-items-center">' +
                        '<span><i class="bi bi-toggle-on"></i> Durum</span>' +
                        '<span class="badge ' + (tour.isActive ? 'bg-success' : 'bg-secondary') + '">' +
                        (tour.isActive ? 'Aktif' : 'Pasif') +
                        '</span>' +
                        '</li>' +
                        '</ul>' +
                        '</div>' +
                        '</div>' +
                        '</div>' +
                        '<div class="modal-footer bg-light border-top">' +
                        '<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Kapat</button>' +
                        '<a href="@Url.Action("Tours", "Admin")" class="btn btn-primary">' +
                        '<i class="bi bi-pencil-square"></i> Tur YÃ¶netim Paneline Git</a>' +
                        '</div>' +
                        '</div>' +
                        '</div>' +
                        '</div>';
                    
                    $('#tourDetailsModal').remove();
                    $('body').append(modalHtml);
                    
                    var modalElement = $('#tourDetailsModal')[0];
                    var modal = new bootstrap.Modal(modalElement);
                    modal.show();
                    
                    $(modalElement).on('hidden.bs.modal', function() {
                        $(this).remove();
                    });
                } else {
                    alert('Tur bilgileri yÃ¼klenirken bir hata oluÅŸtu.');
                }
            },
            error: function() {
                alert('Tur bilgileri yÃ¼klenirken bir hata oluÅŸtu.');
            }
        });
    }
    </script>
}

<style>
    /* Animasyonlu Telefon Butonu */
    .animated-phone-button {
        display: inline-flex;
        align-items: center;
        gap: 10px;
        padding: 12px 24px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        text-decoration: none;
        border-radius: 50px;
        font-weight: 600;
        font-size: 1.1rem;
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }
    
    .animated-phone-button::before {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.3);
        transform: translate(-50%, -50%);
        transition: width 0.6s, height 0.6s;
    }
    
    .animated-phone-button:hover::before {
        width: 300px;
        height: 300px;
    }
    
    .animated-phone-button:hover {
        transform: translateY(-3px) scale(1.05);
        box-shadow: 0 8px 25px rgba(102, 126, 234, 0.6);
    }
    
    .animated-phone-button:active {
        transform: translateY(-1px) scale(1.02);
    }
    
    .phone-icon {
        font-size: 1.5rem;
        animation: phoneRing 2s ease-in-out infinite;
        display: inline-block;
    }
    
    @@keyframes phoneRing {
        0%, 100% {
            transform: rotate(0deg);
        }
        10%, 30%, 50%, 70%, 90% {
            transform: rotate(-10deg);
        }
        20%, 40%, 60%, 80% {
            transform: rotate(10deg);
        }
    }
    
    .phone-number {
        position: relative;
        z-index: 1;
    }
    
    .animated-phone-button .phone-icon {
        position: relative;
        z-index: 1;
    }
</style>

